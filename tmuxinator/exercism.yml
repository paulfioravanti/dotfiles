# ~/.tmuxinator/exercism.yml

<% lang = @args[0] %>
<% exercise = @args[1] %>

name: exercism
# Eg: mux exercism ruby hello-world => exercism/ruby/hello-world
root: ~/exercism/<%= lang %>/<%= exercise %>

on_project_first_start:
  <% if lang == "elm" %>
  - npm install
  <% end %>
  # Grip
  - open --background http://localhost:6419

pre_window:
  # NOTE: uncomment if I find that I need to use language versions
  # other than the latest.
  # <% if lang == "ruby" %>
  # - asdf local ruby 2.6.1
  # <% elsif lang == "elixir" %>
  # - asdf local elixir 1.7.2-otp-21
  # <% elsif lang == "elm" %>
  # - asdf local elm 0.18.0
  # <% end %>

startup_window: editor

windows:
  - editor: vim
  <% if lang == "ruby" %>
  - tests: guard --guardfile ~/exercism/ruby/Guardfile
  - console: irb
  <% elsif lang == "elixir" %>
  <% underscored_filename = exercise.tr("-", "_") %>
  <% exercise_filename = "#{underscored_filename}.exs" %>
  <% test_filename = "#{underscored_filename}_test.exs" %>
  # brew install watchexec just
  # https://github.com/watchexec/watchexec
  # https://github.com/casey/just
  - tests: >
      watchexec
      --watch <%= exercise_filename %>
      --watch <%= test_filename %>
      --clear
      just tests
      <%= "#{exercise}/#{exercise_filename}" %>
      <%= "#{exercise}/#{test_filename}" %>
  - console: iex
  <% elsif lang == "elm" %>
  - tests: elm-test --watch
  - console: elm repl
  <% end %>
  # brew install grip
  # https://github.com/joeyespo/grip
  - grip: grip
