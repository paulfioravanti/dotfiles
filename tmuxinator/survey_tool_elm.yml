# ~/.tmuxinator/survey_tool_elm.yml

name: survey_tool_elm
root: ~/elm/survey_tool_elm

# Runs before everything. Use it to start daemons etc.
on_project_first_start:
  - asdf local elixir 1.6.4
  - asdf local erlang 20.3.2
  - asdf local nodejs 9.9.0
  - asdf local elm 0.18.0
  # Back end
  - open --background http://localhost:4000/survey_results
  # Front end
  - open --background http://localhost:3000
  # Grip
  - open --background http://localhost:6419

# Runs in each window and pane before window/pane specific commands. Useful for setting up interpreter versions.
# pre_window:

# Specifies (by name or index) which window will be selected on project startup. If not set, the first window is used.
startup_window: editor

windows:
  - editor: vim
  - front_tests:
      root: ~/elm/survey_tool_elm/front_end
      panes:
        # - elm-app test --watch
        # Uses `just` and `watchexec` to run both
        # elm-verify-examples and elm-test
        # - watchexec --watch src --watch tests --clear just test
        # Uses `just` and `watchexec` to run both
        # elm-verify-examples and elm-coverage (which runs elm-test)
        # src directory is ignored here because elm-coverage ends up touching
        # every file during its instrumentation phase, leading to infinite
        # loops.
        - watchexec --ignore src --watch tests --ignore tests/elm-package.json --clear just test
  - front_console:
      root: ~/elm/survey_tool_elm/front_end
      panes:
        - elm-app repl
  - front_server:
      root: ~/elm/survey_tool_elm/front_end
      panes:
        - elm-app start
  - back_tests:
      root: ~/elm/survey_tool_elm/back_end
      panes:
        - mix test.watch
  - back_server:
      root: ~/elm/survey_tool_elm/back_end
      panes:
        - iex -S mix
  - grip: grip
